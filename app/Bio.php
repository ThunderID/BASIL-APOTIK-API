<?php

namespace App;

use Illuminate\Database\Eloquent\Model;
use Illuminate\Validation\Rule;

class Bio extends Model
{
    // --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    // TRAITS
    // --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

    // --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    // VARIABLES
    // --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    protected $table = 'bios';

    protected $fillable = [
        'user_id',
        'name',
        'phone',
        'title',
        'birthdate',
        'pin',
        'passport',
        'address',
    ];

    public $timestamps = true;

    protected $hidden = [
    ];

    protected $casts = [
    ];

    protected $dates = [
        'birthdate'
    ];

    protected $touches = [
    ];

    protected $observables = [
    ];

    // --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    // CONFIGURATIONS
    // --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    
    // --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    // BOOT
    // --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

    // --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    // CONSTRUCT
    // --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    
    // --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    // RELATIONSHIP
    // --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    public function user()
    {
        return $this->belongsTo(User::class);
    }
    // --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    // BOOT
    // --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

    // --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    // STATIC FUNCTION
    // --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

    // --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    // FUNCTION
    // --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    public function getRules()
    {
        $rules['user_id']   = ['nullable', 'exists:' . app()->make(User::class)->getTable() . ',id'];
        $rules['name']      = ['required', 'string'];
        $rules['phone']     = ['required', 'string'];
        $rules['birthdate'] = ['required', 'date'];
        $rules['pin']       = ['nullable', 'string'];
        $rules['title']     = ['nullable', 'in:MR,MRS,MS'];
        $rules['passport']  = ['nullable', 'string'];
        $rules['address']   = ['nullable', 'json'];

        return $rules;
    }

    // --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    // ACCESSOR
    // --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    
    // --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    // MUTATOR
    // --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

    // --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    // QUERY
    // --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    public function scopePhone($q, String $v)
    {
        return $q->where('phone', $v);
    }
}
