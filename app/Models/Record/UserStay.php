<?php

namespace App\Models\Record;

use Illuminate\Database\Eloquent\Model;

class UserStay extends Model
{
	protected $table 	= 'user_stays';
    // --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
	// TRAITS
	// --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

	// --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
	// VARIABLES
	// --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
	protected $fillable = [
		'user_id',
		'reception_line_id',
		'rating',
		'comment',
	];

	public $timestamps = true;

	protected $hidden = [
	];

	protected $casts = [
	];

	protected $dates = [
		'deleted_at'
	];

	protected $touches = [
	];

	protected $observables = [
	];

	// --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
	// CONFIGURATIONS
	// --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

	// --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
	// BOOT
	// --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

	// --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
	// CONSTRUCT
	// --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
	
	// --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
	// RELATIONSHIP
	// --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
	public function reception() {
		return $this->reception_line->reception();
	}

	public function room() {
		return $this->reception_line->room();
	}

	public function user() {
		return $this->belongsTo(\App\User::class);
	}

	public function voucher($date = null) {
		if(is_null($date)){
			$date 	= now();
		}
		return $this->reception_line->voucher();
	}

	public function room_services() {
		return $this->hasMany(RoomService::class, 'reception_line_id', 'reception_line_id');
	}

	public function reception_line() {
		return $this->belongsTo(ReceptionLine::class);
	}

	public function vouchers() {
		return $this->reception_line->vouchers();
	}

	public function ga_entries() {
		return $this->reception_line->ga_entries();
	}
	// --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
	// BOOT
	// --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

	// --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
	// STATIC FUNCTION
	// --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

	// --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
	// FUNCTION
	// --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
	public function getRules()
	{
		$rules['user_id']			= ['required', 'integer', 'exists:'. app()->make(\App\User::class)->getTable() . ',id'];
		$rules['reception_line_id']	= ['required', 'integer', 'exists:'. app()->make(ReceptionLine::class)->getTable() . ',id'];
		$rules['rating']			= ['nullable', 'integer'];
		$rules['comment']			= ['nullable', 'string'];
		
		
		return $rules;
	}
	
	// --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
	// ACCESSOR
	// --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
	
	// --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
	// MUTATOR
	// --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

	// --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
	// QUERY
	// --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
}
