<?php

namespace App\Models\Record;

use Illuminate\Database\Eloquent\Model;
use App\Models\Focashier\Invoice;

class GAEntry extends Model
{
	protected $table 	= 'ga_entries';
    // --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
	// TRAITS
	// --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

	// --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
	// VARIABLES
	// --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
	protected $fillable = [
		'reception_id',
		'invoice_id',
		'ref_type',
		'ref_id',
		'room_id',
		'description',
		'date',
		'amount',
	];

	public $timestamps = true;

	protected $hidden = [
	];

	protected $casts = [
	];

	protected $dates = [
		'deleted_at',
		'date'
	];

	protected $touches = [
	];

	protected $observables = [
	];

	// --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
	// CONFIGURATIONS
	// --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

	// --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
	// BOOT
	// --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

	// --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
	// CONSTRUCT
	// --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
	
	// --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
	// RELATIONSHIP
	// --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
	public function reception()
	{
		return $this->belongsTo(Reception::class, 'reception_id');
	}


	// --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
	// BOOT
	// --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

	// --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
	// STATIC FUNCTION
	// --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

	// --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
	// FUNCTION
	// --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
	public function getRules()
	{
		$rules['invoice_id']	= ['nullable', 'integer', 'exists:'. app()->make(Invoice::class)->getTable() . ',id'];
		$rules['reception_id']	= ['required', 'integer', 'exists:'. app()->make(Reception::class)->getTable() . ',id'];
		$rules['ref_type'] 		= ['nullable', 'string'];
		$rules['ref_id']   		= ['nullable', 'required_with:ref_type', 'integer'];
		if ($this->ref_type && $this->ref_id)
		{
			$rules['ref_id'][] 	= 'exists:' . app()->make($this->ref_type)->getTable() . ',id';
		}
		$rules['room_id']  		= ['nullable', 'numeric'];

		$rules['description'] 	= ['nullable', 'string'];
		$rules['amount'] 		= ['required', 'numeric'];
		$rules['date'] 		    = ['required', 'date'];
		
		
		return $rules;
	}
	
	// --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
	// ACCESSOR
	// --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
	
	// --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
	// MUTATOR
	// --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

	// --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
	// QUERY
	// --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
}
